<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CamacPulseVisualizer | Maximum Visibility</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root { --teal: #41797e; --navy: #001935; --bg: #f8fafc; --accent: #5aa4ab; }
        body { font-family: system-ui, -apple-system, sans-serif; background: var(--bg); color: var(--navy); margin: 0; padding: 0 0 120px 0; }
        
        header { background: var(--navy); color: white; padding: 25px; text-align: center; border-bottom: 4px solid var(--teal); box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .wrapper { max-width: 1250px; margin: 30px auto; padding: 0 25px; }
        
        /* Stats Display */
        #statsDash { display: none; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; }
        .card { background: var(--navy); color: white; padding: 20px; border-radius: 12px; text-align: center; border: 1px solid var(--teal); }
        .card small { text-transform: uppercase; font-size: 10px; opacity: 0.7; display: block; letter-spacing: 1px; }
        .card div { font-size: 28px; font-weight: 800; color: var(--accent); margin-top: 5px; }

        /* Main Panel */
        .panel { background: white; padding: 40px; border-radius: 16px; box-shadow: 0 4px 25px rgba(0,0,0,0.06); }
        .upload-section { border: 3px dashed #cbd5e1; padding: 60px; text-align: center; cursor: pointer; border-radius: 15px; background: #fafafa; }
        .upload-section:hover { border-color: var(--teal); background: #f0fdfa; }
        
        .controls { display: none; margin-top: 20px; background: #f1f5f9; padding: 25px; border-radius: 12px; border: 1px solid #e2e8f0; }
        .grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 25px; }
        label { font-size: 11px; font-weight: bold; color: #64748b; text-transform: uppercase; }
        select, input { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #cbd5e1; margin-top: 8px; font-weight: 600; }

        /* Larger Canvas for Full Window */
        canvas { width: 100%; height: 600px; margin-top: 30px; display: block; }

        /* Bottom Navigation Bar */
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; background: var(--navy); padding: 18px 0; border-top: 4px solid var(--teal); text-align: center; z-index: 1000; }
        .btn-full { background: var(--teal); color: white; padding: 14px 40px; border-radius: 30px; border: none; font-weight: 800; font-size: 13px; cursor: pointer; text-transform: uppercase; letter-spacing: 1px; transition: 0.2s; }
        .btn-full:hover { background: #356367; transform: scale(1.05); }
    </style>
</head>
<body>

<header><strong>CAMACPULSE ANALYTICS SYSTEM</strong></header>

<div class="wrapper">
    <div id="statsDash">
        <div class="card"><small>Pulse Average</small><div id="outAvg">0</div></div>
        <div class="card"><small>Trajectory</small><div id="outTrend">---</div></div>
        <div class="card"><small>Projected Next</small><div id="outFore">0</div></div>
    </div>

    <div class="panel">
        <div class="upload-section" id="dropZone">
            <h2 style="margin:0 0 10px 0;">Intelligence Import</h2>
            <p>Click to upload your dataset for full visual projection</p>
            <input type="file" id="fileIn" accept=".xlsx, .xls, .csv" style="margin-top: 15px;">
        </div>

        <div class="controls" id="ctrls">
            <div class="grid">
                <div><label>X-Axis (Horizontal)</label><select id="selX" onchange="run()"></select></div>
                <div><label>Y-Axis (Vertical)</label><select id="selY" onchange="run()"></select></div>
                <div><label>Target Goal Line</label><input type="number" id="goal" oninput="run()" placeholder="Enter value..."></div>
            </div>
            <canvas id="pulseCanvas"></canvas>
        </div>
    </div>
</div>

<div class="bottom-nav">
    <button class="btn-full" onclick="
